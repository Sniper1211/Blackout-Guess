## 问题分析与解决方案

### 1. SQL使用说明

用户需要在Supabase控制台中运行SQL：

1. 访问 <https://app.supabase.com/>
2. 选择对应项目
3. 进入SQL编辑器
4. 粘贴SQL语句并运行

### 2. 日历不能访问昨天题目的根本原因

经过分析，可能的原因包括：

#### A. 数据库配置问题

* `app_settings`表中的`daily_mode_enabled`可能未设置为`true`

* 数据库中可能没有从2026-01-21到2026-01-28的题目数据

* 题目状态可能不是`published`

#### B. 代码逻辑问题

* 日历渲染时可能没有正确获取题目数据

* 日期映射可能有时区问题

* 题目加载逻辑可能有bug

### 3. 解决方案

#### 第一步：数据库配置检查与修复

1. 运行SQL启用每日一题模式
2. 检查并添加题目数据
3. 验证题目状态和日期格式

#### 第二步：代码调试与修复

1. 添加详细的日志记录
2. 修复可能的时区问题
3. 优化题目加载逻辑

#### 第三步：测试验证

1. 使用测试页面验证数据库连接
2. 测试日历点击功能
3. 验证题目加载

### 4. 具体实施步骤

#### A. 数据库操作

1. 运行`enable_daily_mode.sql`脚本
2. 检查题目数据：`SELECT * FROM question_bank WHERE publish_date >= '2026-01-21' AND publish_date <= '2026-01-28'`
3. 如果没有数据，添加示例题目

#### B. 代码修改

1. 在`app.js`的`loadSpecificQuestion`函数中添加详细日志
2. 在`UIManager.js`的日历渲染中添加调试信息
3. 修复日期时区处理逻辑

#### C. 测试验证

1. 使用`test_daily_mode.html`测试数据库连接
2. 在主应用中测试日历功能
3. 验证题目加载和显示

### 5. 预期结果

1. SQL成功运行，每日一题模式启用
2. 数据库中有从1月21日到28日的题目
3. 日历可以正确显示和点击题目
4. 点击昨天日期可以加载对应题目

